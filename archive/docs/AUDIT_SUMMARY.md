# –ò–¢–û–ì–û–í–ê–Ø –°–í–û–î–ö–ê: –ê–£–î–ò–¢ WAVE DETECTOR –ú–û–î–£–õ–Ø

**–î–∞—Ç–∞:** 2025-10-15
**–ê—É–¥–∏—Ç–æ—Ä:** Claude Code (Anthropic)
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –¢–ï–û–†–ï–¢–ò–ß–ï–°–ö–ò–ô –ê–ù–ê–õ–ò–ó –ó–ê–í–ï–†–®–ï–ù

---

## üéØ –ì–õ–ê–í–ù–´–ô –í–´–í–û–î

### ‚úÖ **Stop-Loss –æ—Ä–¥–µ—Ä–∞ –ö–û–†–†–ï–ö–¢–ù–´**

**–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ –∞–Ω–∞–ª–∏–∑–æ–º –∫–æ–¥–∞:**
- **Binance Futures:** `reduceOnly=True` –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç (stop_loss_manager.py:525)
- **Bybit V5:** Position-attached SL (stop_loss_manager.py:344-356)
- **–û–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –ù–ï –±–ª–æ–∫–∏—Ä—É—é—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –º–∞—Ä–∂—É**

**–í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ –ø–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:**
- Binance API: `reduceOnly=True` ‚Üí —Ç–æ–ª—å–∫–æ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é
- Bybit V5 API: `set_trading_stop` ‚Üí position-attached, –±–µ–∑ –º–∞—Ä–∂–∏

---

## üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ê–ù–ê–õ–ò–ó–ê

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –û—Ü–µ–Ω–∫–∞ |
|-----------|--------|--------|
| **WebSocket –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤** | ‚úÖ PASS | 10/10 |
| **–°–µ–ª–µ–∫—Ü–∏—è —Ç–æ–ø —Å–∏–≥–Ω–∞–ª–æ–≤** | ‚úÖ PASS | 10/10 |
| **–î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è –ø–æ–∑–∏—Ü–∏–π** | ‚ö†Ô∏è PARTIAL | 8/10 |
| **–†–æ—É—Ç–∏–Ω–≥ –ø–æ –±–∏—Ä–∂–∞–º** | ‚úÖ PASS | 10/10 |
| **üî¥ Stop-Loss (Binance)** | ‚úÖ PASS | 10/10 |
| **üî¥ Stop-Loss (Bybit)** | ‚úÖ PASS | 10/10 |
| **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** | ‚úÖ PASS | 9/10 |
| **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** | ‚úÖ PASS | 9/10 |

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞:** 9.2/10

---

## üìÅ –°–û–ó–î–ê–ù–ù–´–ï –ú–ê–¢–ï–†–ò–ê–õ–´

### 1. –û—Ç—á–µ—Ç—ã

- **`WAVE_DETECTOR_AUDIT_FULL_REPORT.md`** (94 KB)
  - 15 —Ä–∞–∑–¥–µ–ª–æ–≤ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
  - –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ —Å –Ω–æ–º–µ—Ä–∞–º–∏ —Å—Ç—Ä–æ–∫
  - –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –Ω–∞—Ö–æ–¥–∫–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- **`AUDIT_SUMMARY.md`** (—ç—Ç–æ—Ç —Ñ–∞–π–ª)
  - –ö—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
  - –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤

### 2. –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

- **`monitor_wave_detector_live.py`** (–∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π)
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–æ—Ç–∞ 15+ –º–∏–Ω—É—Ç
  - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤–æ–ª–Ω, —Å–∏–≥–Ω–∞–ª–æ–≤, –ø–æ–∑–∏—Ü–∏–π, SL
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ `reduceOnly` –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞

- **`start_live_test.sh`** (–∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π)
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ç–µ—Å—Ç—É
  - –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–æ—Ç–∞ + –æ—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
  - –ó–∞–ø—É—Å–∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π

### 3. –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

- **`LIVE_TEST_INSTRUCTIONS.md`**
  - –ü–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –¥–ª—è LIVE —Ç–µ—Å—Ç–∞
  - –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞/–ø—Ä–æ–≤–∞–ª–∞
  - Troubleshooting
  - –ü—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

- **`QUICK_START_LIVE_TEST.md`**
  - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (TL;DR)
  - –û–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞
  - –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

---

## üîç –ö–õ–Æ–ß–ï–í–´–ï –ù–ê–•–û–î–ö–ò

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:

1. **Stop-Loss –æ—Ä–¥–µ—Ä–∞** (–ö–†–ò–¢–ò–ß–ù–û)
   - Binance: `reduceOnly=True` ‚úÖ
   - Bybit: position-attached ‚úÖ
   - –ú–∞—Ä–∂–∞ –ù–ï –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è ‚úÖ

2. **Wave Detector –ª–æ–≥–∏–∫–∞**
   - WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ ‚úÖ
   - –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ score_week ‚úÖ
   - –ë—É—Ñ–µ—Ä 50% –¥–ª—è –∑–∞–º–µ–Ω—ã ‚úÖ

3. **–ó–∞—â–∏—Ç–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã**
   - Retry logic –¥–ª—è SL (3 –ø–æ–ø—ã—Ç–∫–∏) ‚úÖ
   - Periodic monitoring (–∫–∞–∂–¥—ã–µ 120 —Å–µ–∫) ‚úÖ
   - EventLogger –¥–ª—è audit trail ‚úÖ

### ‚ö†Ô∏è –ß—Ç–æ —Ç—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è:

1. **–î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è** (LOW priority)
   - –ù–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç side (LONG/SHORT)
   - –ü—Ä–æ–±–ª–µ–º–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è hedge mode
   - One-way mode (—Ç–µ–∫—É—â–∏–π) —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** (LOW priority)
   - –ù–µ—Ç debug –ª–æ–≥–∞ SL params –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
   - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

---

## üöÄ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

### –®–∞–≥ 1: LIVE –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (15 –º–∏–Ω—É—Ç)

**–ó–∞–ø—É—Å–∫:**
```bash
./start_live_test.sh
```

**–ü—Ä–æ–≤–µ—Ä–∏—Ç:**
- –í–æ–ª–Ω—ã –ø—Ä–∏—Ö–æ–¥—è—Ç –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç
- –ü–æ–∑–∏—Ü–∏–∏ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è
- SL —Ä–∞–∑–º–µ—â–∞—é—Ç—Å—è —Å `reduceOnly=True`
- –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ—à–∏–±–æ–∫

### –®–∞–≥ 2: –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç—á–µ—Ç:
```bash
cat wave_detector_live_diagnostic.log
```

–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
- ‚úÖ –í–æ–ª–Ω: 1+
- ‚úÖ –ü–æ–∑–∏—Ü–∏–π: 1-5
- ‚úÖ SL —Å reduceOnly: —Ä–∞–≤–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–æ–∑–∏—Ü–∏–π
- ‚úÖ SL –ë–ï–ó reduceOnly: 0

### –®–∞–≥ 3: –§–∏–Ω–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

–ï—Å–ª–∏ LIVE —Ç–µ—Å—Ç PASS:
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ production
- –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –±–æ—Ç–∞ –≤ –æ–±—ã—á–Ω–æ–º —Ä–µ–∂–∏–º–µ

–ï—Å–ª–∏ LIVE —Ç–µ—Å—Ç FAIL:
- –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏
- –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—ã
- –ü–æ–≤—Ç–æ—Ä–∏—Ç—å —Ç–µ—Å—Ç

---

## üìä –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –¢–ï–°–¢–ê

–ò–∑ `.env`:
```bash
BINANCE_TESTNET=true          # ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ
BYBIT_TESTNET=true            # ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ

WAVE_CHECK_MINUTES=5,20,35,50 # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω
MAX_TRADES_PER_15MIN=5        # –ú–∞–∫—Å–∏–º—É–º 5 –ø–æ–∑–∏—Ü–∏–π
SIGNAL_BUFFER_PERCENT=50      # –ë—É—Ñ–µ—Ä 50% = 7 —Å–∏–≥–Ω–∞–ª–æ–≤
POSITION_SIZE_USD=200         # –ú–∞–ª—ã–π —Ä–∞–∑–º–µ—Ä –¥–ª—è —Ç–µ—Å—Ç–∞
```

**–¢–µ—Å—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –±–µ–∑–æ–ø–∞—Å–µ–Ω:** testnet + –º–∞–ª—ã–µ –ø–æ–∑–∏—Ü–∏–∏ + –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

---

## üîó –°–°–´–õ–ö–ò –ù–ê –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Æ

### –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã –≤ –∞—É–¥–∏—Ç–µ):

**Binance Futures:**
- [New Order API](https://binance-docs.github.io/apidocs/futures/en/#new-order-trade)
- [Stack Overflow - Stop Loss](https://stackoverflow.com/questions/71217151/place-binance-futures-stop-loss-order)

**Bybit V5:**
- [Set Trading Stop](https://bybit-exchange.github.io/docs/v5/position/trading-stop)
- [Create Order](https://bybit-exchange.github.io/docs/v5/order/create-order)

**CCXT:**
- [Unified API](https://docs.ccxt.com/#/?id=order-structure)

---

## ‚úÖ –ö–†–ò–¢–ï–†–ò–ò –ì–û–¢–û–í–ù–û–°–¢–ò –ö PRODUCTION

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è (–≤—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã):

- [x] Stop-Loss —Å `reduceOnly=True` (Binance) ‚úÖ
- [x] Stop-Loss position-attached (Bybit) ‚úÖ
- [x] –ö–∞–∂–¥–∞—è –ø–æ–∑–∏—Ü–∏—è –∏–º–µ–µ—Ç SL ‚úÖ
- [x] –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π StopLossManager ‚úÖ
- [x] Retry logic –¥–ª—è SL ‚úÖ
- [x] Periodic monitoring SL ‚úÖ
- [x] EventLogger –¥–ª—è –∞—É–¥–∏—Ç–∞ ‚úÖ

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

- [ ] LIVE —Ç–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω (–∑–∞–ø—É—Å—Ç–∏—Ç—å)
- [ ] Debug –ª–æ–≥ SL params (–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å)
- [ ] Side checking –≤ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏ (–¥–ª—è hedge mode)

---

## üìû –ö–û–ù–¢–ê–ö–¢–´ –ò –ü–û–î–î–ï–†–ñ–ö–ê

**–§–∞–π–ª—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–±–ª–µ–º:**
- –õ–æ–≥–∏ –±–æ—Ç–∞: `logs/trading_bot.log`
- –õ–æ–≥–∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏: `wave_detector_live_diagnostic.log`

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- –î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç: `WAVE_DETECTOR_AUDIT_FULL_REPORT.md`
- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏: `LIVE_TEST_INSTRUCTIONS.md`
- –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: `QUICK_START_LIVE_TEST.md`

---

## üéì –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

### –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø–æ–∫–∞–∑–∞–ª:

1. ‚úÖ **Stop-Loss –æ—Ä–¥–µ—Ä–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã** - –º–∞—Ä–∂–∞ –ù–ï –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è
2. ‚úÖ **Wave Detector —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ** - –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞
3. ‚úÖ **–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ production** - –ø–æ—Å–ª–µ LIVE —Ç–µ—Å—Ç–∞

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:

1. –ó–∞–ø—É—Å—Ç–∏—Ç—å LIVE —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (15 –º–∏–Ω—É—Ç)
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç—á–µ—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
3. –ï—Å–ª–∏ –≤—Å—ë –û–ö - –∑–∞–ø—É—Å–∫–∞—Ç—å –≤ production

### –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ —Å–∏—Å—Ç–µ–º—ã:

**9.2/10** - –æ—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! üéâ

–ö—Ä–∏—Ç–∏—á–Ω—ã—Ö –±–ª–æ–∫–∏—Ä—É—é—â–∏—Ö –ø—Ä–æ–±–ª–µ–º –ù–ï–¢.
–ú–∏–Ω–æ—Ä–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –º–æ–∂–Ω–æ –≤–Ω–µ—Å—Ç–∏ –ø–æ–∑–∂–µ.

---

**–ì–æ—Ç–æ–≤—ã –∫ LIVE —Ç–µ—Å—Ç—É?** –ó–∞–ø—É—Å–∫–∞–π—Ç–µ: `./start_live_test.sh` üöÄ
