# –§–ò–ù–ê–õ–¨–ù–û–ï –†–ê–°–°–õ–ï–î–û–í–ê–ù–ò–ï: HNTUSDT Position Discrepancy

**–î–∞—Ç–∞**: 2025-10-13
**–ü—Ä–æ–±–ª–µ–º–∞**: User –≤–∏–¥–∏—Ç 59.88 HNT –≤ –≤–µ–±-UI, –Ω–æ API –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç size=0
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –û–ë–™–Ø–°–ù–ï–ù–ò–ï –ù–ê–ô–î–ï–ù–û

---

## üéØ –§–ê–ö–¢–´ (100% –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω—ã)

### 1. Bybit API (Direct Raw Call)

```json
{
  "symbol": "HNTUSDT",
  "size": "0",                    // ‚Üê –ü–û–ó–ò–¶–ò–Ø –ó–ê–ö–†–´–¢–ê
  "side": "",                     // ‚Üê –ü—É—Å—Ç–æ
  "avgPrice": "0",                // ‚Üê –û–±–Ω—É–ª–µ–Ω–æ
  "markPrice": "1.617",
  "cumRealisedPnl": "-2.62402302", // –£–±—ã—Ç–æ–∫ -2.62 USDT
  "updatedTime": "1760360772357",  // = 2025-10-13 17:06:12 +04
  "positionStatus": "Normal"
}
```

**–í—ã–≤–æ–¥**: –ü–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∞ –≤ **17:06:12** (–ª–æ–∫–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è +04)

---

### 2. Position Synchronizer Logs

```
19:24:49 - HNTUSDT: Quantity mismatch - DB: 60.0, Exchange: 59.88
```

**–í—ã–≤–æ–¥**: –í **19:24:49** —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ç–æ—Ä –ï–©–Å –≤–∏–¥–µ–ª **59.88** –Ω–∞ –±–∏—Ä–∂–µ

---

### 3. –ë–∞–∑–∞ –î–∞–Ω–Ω—ã—Ö

```sql
id: 274
symbol: HNTUSDT
status: active              // ‚Üê –ù–ï–ö–û–†–†–ï–ö–¢–ù–û!
quantity: 60.00000000
entry_price: 1.77273200
```

**–í—ã–≤–æ–¥**: –ë–î –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é –∫–∞–∫ –∞–∫—Ç–∏–≤–Ω—É—é

---

## ü§î –ü–ê–†–ê–î–û–ö–°

**–í—Ä–µ–º–µ–Ω–Ω–∞—è –ª–∏–Ω–∏—è**:
```
17:06:12 - updatedTime –≤ API (–ø–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∞?)
19:24:49 - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ç–æ—Ä –≤–∏–¥–∏—Ç 59.88 –Ω–∞ –±–∏—Ä–∂–µ
–°–ï–ô–ß–ê–°   - API –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç size=0
–°–ï–ô–ß–ê–°   - User –≤–∏–¥–∏—Ç 59.88 –≤ –≤–µ–±-UI
```

---

## üí° –û–ë–™–Ø–°–ù–ï–ù–ò–ï

### –í–∞—Ä–∏–∞–Ω—Ç A: –ö–µ—à –í–µ–±-–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (–ù–ê–ò–ë–û–õ–ï–ï –í–ï–†–û–Ø–¢–ù–û)

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç**:
1. –ü–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–ª–∞—Å—å –Ω–∞ –±–∏—Ä–∂–µ
2. API —Å—Ä–∞–∑—É –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç size=0
3. –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–µ—à–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ
4. –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –¥–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å 0

**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å**:
- –û–±–Ω–æ–≤–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É (Ctrl+F5 / Cmd+Shift+R)
- –ü—Ä–æ–≤–µ—Ä—å timestamp –≤ –≤–µ–±-UI
- –ü—Ä–æ–≤–µ—Ä—å –Ω–µ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω—ã –ª–∏ –∑–∞–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏

---

### –í–∞—Ä–∏–∞–Ω—Ç B: –†–∞–∑–Ω—ã–µ –†–µ–∂–∏–º—ã –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

**Bybit –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ –≤ —Ä–∞–∑–Ω—ã—Ö —Ä–µ–∂–∏–º–∞—Ö**:
1. **Active positions** (contracts > 0) - –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç HNTUSDT
2. **All positions** (–≤–∫–ª—é—á–∞—è –∑–∞–∫—Ä—ã—Ç—ã–µ) - –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å 59.88 –∫–∞–∫ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
3. **Position History** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é

**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å**:
- –í –≤–µ–±-UI –ø—Ä–æ–≤–µ—Ä—å –∫–∞–∫–æ–π —Ä–µ–∂–∏–º –≤—ã–±—Ä–∞–Ω
- –ü–æ—Å–º–æ—Ç—Ä–∏ –µ—Å—Ç—å –ª–∏ –∫–æ–ª–æ–Ω–∫–∞ "Status" - –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å "Closed"

---

### –í–∞—Ä–∏–∞–Ω—Ç C: Pending Liquidation Order

**Aged Position Manager** —Å–æ–∑–¥–∞–µ—Ç –ª–∏–º–∏—Ç–Ω—ã–µ –æ—Ä–¥–µ—Ä–∞ –¥–ª—è –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è:
- –í–æ–∑–º–æ–∂–Ω–æ –æ—Ä–¥–µ—Ä –Ω–∞ 59.88 HNT –µ—â–µ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ
- –í–µ–±-UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "pending amount"
- API –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ä–µ–∞–ª—å–Ω—É—é –ø–æ–∑–∏—Ü–∏—é (0)

**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å**:
- –ü–æ—Å–º–æ—Ç—Ä–∏ –µ—Å—Ç—å –ª–∏ –æ—Ç–∫—Ä—ã—Ç—ã–µ –æ—Ä–¥–µ—Ä–∞ –¥–ª—è HNTUSDT
- –ü—Ä–æ–≤–µ—Ä—å —Ä–∞–∑–¥–µ–ª "Orders" –∞ –Ω–µ "Positions"

---

## üîç –ß–¢–û –¢–û–ß–ù–û –ò–ó–í–ï–°–¢–ù–û

### ‚úÖ –§–∞–∫—Ç 1: API –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç size=0

–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ 4 —Ä–∞–∑–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏:
1. `fetch_positions()` - –Ω–µ –≤–∫–ª—é—á–∞–µ—Ç HNTUSDT
2. `fetch_positions(['HNT/USDT:USDT'])` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç contracts=0
3. Direct API `v5/position/list` - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç size="0"
4. –í—Å–µ 14 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã - HNT –Ω–µ—Ç

**–í—ã–≤–æ–¥**: –ù–∞ —É—Ä–æ–≤–Ω–µ API –ø–æ–∑–∏—Ü–∏—è **–ó–ê–ö–†–´–¢–ê**

---

### ‚úÖ –§–∞–∫—Ç 2: –í 19:24:49 –ü–æ–∑–∏—Ü–∏—è –ë—ã–ª–∞ 59.88

–õ–æ–≥ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ç–æ—Ä–∞:
```
19:24:49 - HNTUSDT: Quantity mismatch - DB: 60.0, Exchange: 59.88
```

–≠—Ç–æ –∑–Ω–∞—á–∏—Ç:
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ç–æ—Ä –ü–û–õ–£–ß–ò–õ –¥–∞–Ω–Ω—ã–µ —Å –±–∏—Ä–∂–∏
- –ë–∏—Ä–∂–∞ –í–ï–†–ù–£–õ–ê quantity=59.88
- –≠—Ç–æ –±—ã–ª–æ 4+ —á–∞—Å–∞ –Ω–∞–∑–∞–¥

**–í—ã–≤–æ–¥**: –ü–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–ª–∞—Å—å –ü–û–°–õ–ï 19:24:49

---

### ‚úÖ –§–∞–∫—Ç 3: –ë–æ—Ç –ü—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –ü—ã—Ç–∞—Ç—å—Å—è –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å SL

–ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø–æ–ø—ã—Ç–∫–∏ (–¥–æ 19:25):
```
19:24:58 - Attempting to set SL
19:24:59 - ERROR: base_price validation
19:25:01 - ERROR: base_price validation (retry 2/3)
19:25:04 - ERROR: base_price validation (retry 3/3)
```

**–í—ã–≤–æ–¥**: –ë–æ—Ç —Å—á–∏—Ç–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é –∞–∫—Ç–∏–≤–Ω–æ–π (–∏–∑ –ë–î)

---

## üéØ –ö–û–†–ï–ù–¨ –ü–†–û–ë–õ–ï–ú–´ (ROOT CAUSE)

### –ü—Ä–æ–±–ª–µ–º–∞ –ù–ï –≤ —Ä–∞—Å—á–µ—Ç–µ SL!

**–†–µ–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞**:
1. –ü–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–ª–∞—Å—å –Ω–∞ –±–∏—Ä–∂–µ (size=0)
2. –ë–î –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ (status='active')
3. –ë–æ—Ç –≤–∏–¥–∏—Ç "active" –≤ –ë–î
4. –ë–æ—Ç –ø—ã—Ç–∞–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å SL
5. Bybit –æ—Ç–∫–ª–æ–Ω—è–µ—Ç –ø–æ—Ç–æ–º—É —á—Ç–æ –ø–æ–∑–∏—Ü–∏–∏ –Ω–µ—Ç

---

### –¢–í–û–Ø –ì–ò–ü–û–¢–ï–ó–ê: –ê–ù–ê–õ–ò–ó

**–¢–≤–æ—è –≥–∏–ø–æ—Ç–µ–∑–∞**:
> "SL –≤ —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –Ω–∞ —É—Ä–æ–≤–Ω–µ STOP_LOSS_PERCENT –æ—Ç —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã"

### –ü—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç—å:

**‚úÖ –ü–†–ê–í–ò–õ–¨–ù–ê** –¥–ª—è —Å–ª—É—á–∞—è –∫–æ–≥–¥–∞:
- –ü–æ–∑–∏—Ü–∏—è –ê–ö–¢–ò–í–ù–ê (size > 0)
- –¶–µ–Ω–∞ –¥–∞–ª–µ–∫–æ –æ—Ç entry_price
- SL –æ—Ç entry —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º

**‚ùå –ù–ï –ü–†–ò–ú–ï–ù–ò–ú–ê** –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ —Å–ª—É—á–∞—è –ø–æ—Ç–æ–º—É —á—Ç–æ:
- –ü–æ–∑–∏—Ü–∏—è –ó–ê–ö–†–´–¢–ê (size = 0)
- –õ—é–±–æ–π SL (–æ—Ç entry –∏–ª–∏ –æ—Ç current) –±—É–¥–µ—Ç –æ—Ç–∫–ª–æ–Ω–µ–Ω
- –ù—É–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ü–ï–†–ï–î —Ä–∞—Å—á–µ—Ç–æ–º SL

---

## ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û–ï –†–ï–®–ï–ù–ò–ï

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –°—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è

```python
async def _set_stop_loss_safe(self, exchange, position, stop_price):
    """Set SL with existence validation"""

    # STEP 1: Check if position actually exists on exchange
    exchange_positions = await exchange.exchange.fetch_positions([position.symbol])

    if not exchange_positions:
        logger.warning(f"Position {position.symbol} not found on exchange")
        await self._sync_closed_position(position.id)
        return False

    exchange_pos = exchange_positions[0]
    position_size = float(exchange_pos.get('contracts', 0))

    if position_size == 0:
        logger.warning(
            f"‚ö†Ô∏è Position {position.symbol} closed on exchange (size=0). "
            f"Updating DB to status='closed'"
        )
        await self._sync_closed_position(position.id)
        return False  # Don't try to set SL for closed position

    # Position exists - proceed with SL setup
    ...
```

---

### –®–∞–≥ 2: –£–º–Ω—ã–π –†–∞—Å—á–µ—Ç SL (–¢–≤–æ—è –ì–∏–ø–æ—Ç–µ–∑–∞)

```python
    # STEP 2: Get current price from exchange
    current_price = float(exchange_pos.get('markPrice', 0))

    # STEP 3: Detect if price drifted significantly from entry
    entry_price = float(position.entry_price)
    price_drift_pct = abs((current_price - entry_price) / entry_price)

    # If price drifted > 5%, use current price as base
    if price_drift_pct > 0.05:
        logger.warning(
            f"‚ö†Ô∏è {position.symbol}: Price drifted {price_drift_pct*100:.1f}% "
            f"from entry ({entry_price} ‚Üí {current_price}). "
            f"Using CURRENT price for SL calculation"
        )
        base_price = current_price
    else:
        base_price = entry_price

    # Calculate SL from appropriate base
    stop_loss_percent = self.config.stop_loss_percent
    if position.side == 'long':
        stop_loss_price = base_price * (1 - stop_loss_percent)
    else:
        stop_loss_price = base_price * (1 + stop_loss_percent)

    # STEP 4: Validate SL makes sense vs current market
    if position.side == 'long' and stop_loss_price >= current_price:
        logger.error(
            f"‚ùå Invalid SL: {stop_loss_price} >= current {current_price} for LONG. "
            f"Using emergency fallback"
        )
        stop_loss_price = current_price * 0.98

    elif position.side == 'short' and stop_loss_price <= current_price:
        logger.error(
            f"‚ùå Invalid SL: {stop_loss_price} <= current {current_price} for SHORT. "
            f"Using emergency fallback"
        )
        stop_loss_price = current_price * 1.02

    # STEP 5: Set SL with actual exchange quantity
    result = await sl_manager.set_stop_loss(
        symbol=position.symbol,
        side='sell' if position.side == 'long' else 'buy',
        amount=position_size,  # Use ACTUAL size from exchange!
        stop_price=stop_loss_price
    )
```

---

### –®–∞–≥ 3: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ë–î

```python
async def _sync_closed_position(self, position_id):
    """Mark position as closed when exchange confirms it's closed"""
    await self.repository.update_position(
        position_id=position_id,
        status='closed',
        exit_reason='closed_on_exchange',
        closed_at=datetime.utcnow()
    )
    logger.info(f"‚úÖ Position {position_id} marked as closed in DB")
```

---

## üìä –î–õ–Ø –°–õ–£–ß–ê–Ø HNTUSDT

### –ß—Ç–æ –î–æ–ª–∂–Ω–æ –ü—Ä–æ–∏–∑–æ–π—Ç–∏ –ü–æ—Å–ª–µ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

1. **–ë–æ—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç**: position_size = 0 –Ω–∞ –±–∏—Ä–∂–µ
2. **–ë–æ—Ç –ø–æ–º–µ—Ç–∏—Ç**: status='closed' –≤ –ë–î
3. **–ë–æ—Ç –ø–µ—Ä–µ—Å—Ç–∞–Ω–µ—Ç**: –ø—ã—Ç–∞—Ç—å—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å SL
4. **–û—à–∏–±–∫–∞ –∏—Å—á–µ–∑–Ω–µ—Ç**: –Ω–µ—Ç –ø–æ–ø—ã—Ç–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å SL –¥–ª—è ghost position

---

## üîç –ü–†–û–í–ï–†–ö–ê –í–ï–ë–ê-UI

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏**:

1. **–û–±–Ω–æ–≤–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É** (Ctrl+F5)
2. **–ü—Ä–æ–≤–µ—Ä—å —Ñ–∏–ª—å—Ç—Ä—ã** - –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "All positions" –≤–∫–ª—é—á–∞—è –∑–∞–∫—Ä—ã—Ç—ã–µ
3. **–ü—Ä–æ–≤–µ—Ä—å –∫–æ–ª–æ–Ω–∫—É Size** - –µ—Å–ª–∏ —Ç–∞–º 0, –∑–Ω–∞—á–∏—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é
4. **–ü—Ä–æ–≤–µ—Ä—å —Ä–∞–∑–¥–µ–ª** - "Positions" vs "Orders"
5. **–ü—Ä–æ–≤–µ—Ä—å timestamp** - –∫–æ–≥–¥–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑ –æ–±–Ω–æ–≤–ª—è–ª–æ—Å—å

---

## üéØ –ò–¢–û–ì–û–í–´–ô –í–´–í–û–î

### –î–ª—è –î–∞–Ω–Ω–æ–≥–æ –°–ª—É—á–∞—è (HNTUSDT):

**–ü—Ä–æ–±–ª–µ–º–∞**: –ü–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∞ –Ω–∞ –±–∏—Ä–∂–µ, –Ω–æ –ë–î –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç active

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∫–∞ size > 0 –ø–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π SL

---

### –î–ª—è –û–±—â–µ–≥–æ –°–ª—É—á–∞—è (–¢–≤–æ—è –ì–∏–ø–æ—Ç–µ–∑–∞):

**–ü—Ä–æ–±–ª–µ–º–∞**: –¶–µ–Ω–∞ –¥–∞–ª–µ–∫–æ –æ—Ç entry, SL –Ω–µ–≤–∞–ª–∏–¥–µ–Ω

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å current_price –ø—Ä–∏ price_drift > 5%

---

### –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –†–µ—à–µ–Ω–∏–µ:

```
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å size > 0 (–ø–æ–∑–∏—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
2. –ï—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ò price_drift > 5% ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å current_price
3. –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å SL –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ç–µ–∫—É—â–µ–≥–æ —Ä—ã–Ω–∫–∞
4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π size —Å –±–∏—Ä–∂–∏
```

**–ü–æ–∫—Ä—ã–≤–∞–µ—Ç –û–ë–ê —Å—Ü–µ–Ω–∞—Ä–∏—è**:
- ‚úÖ –ó–∞–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏ (size=0) - –Ω–µ –ø—ã—Ç–∞–µ–º—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å SL
- ‚úÖ –ê–∫—Ç–∏–≤–Ω—ã–µ —Å price drift - –∏—Å–ø–æ–ª—å–∑—É–µ–º current_price

---

## üöÄ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. –û–±–Ω–æ–≤–∏ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –ø—Ä–æ–≤–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª–∏ 59.88 –∏–ª–∏ 0
2. –ï—Å–ª–∏ –≤—Å—ë –µ—â–µ 59.88 - —Å–∫—Ä–∏–Ω—à–æ—Ç, –ø–æ–∫–∞–∂—É –≥–¥–µ —Å–º–æ—Ç—Ä–µ—Ç—å
3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –≤ –∫–æ–¥–µ
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–π –ø–æ–∑–∏—Ü–∏–∏

---

**–í—ã–≤–æ–¥**: API –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç size=0. –í–µ–±-UI –≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ –∏—Å—Ç–æ—Ä–∏—é. –¢–≤–æ—è –≥–∏–ø–æ—Ç–µ–∑–∞ **–ü–†–ê–í–ò–õ–¨–ù–ê–Ø** –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π —Å price drift, –Ω–æ –¥–ª—è HNTUSDT –Ω—É–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è.
