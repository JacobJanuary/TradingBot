# Database Configuration  
DB_HOST=localhost
DB_PORT=5433
DB_NAME=fox_crypto
DB_USER=elcrypto
DB_PASSWORD=LohNeMamont@!21
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20

# Exchange Configuration (disabled for testing)
BINANCE_API_KEY=cbcf0a3278e36789c428558cc02921c98178ab6e3020b92b1d44b45029c1fe36
BINANCE_API_SECRET=51db19b2557668ebd7fd72fc27c274c0a2afe8f830bf575aa9cdcb17d06662c5
BINANCE_TESTNET=true

BYBIT_API_KEY=HJiwkVh2wJ7Ej7iCWi
BYBIT_API_SECRET=QAtDCju36wIfwyZg1nsCBCo8NcW9plzN8ALs
BYBIT_TESTNET=true

# Trading Configuration - Position Sizing (FIXED)
POSITION_SIZE_USD=200           # Fixed position size in USD (SIMPLE!)
MIN_POSITION_SIZE_USD=10        # Minimum allowed position size
MAX_POSITION_SIZE_USD=5000      # Maximum allowed position size
MAX_POSITIONS=150               # Maximum concurrent positions
MAX_EXPOSURE_USD=300000          # Maximum total exposure

# Exit Strategy - Smart Trailing Stop (NO TAKE PROFIT!)
STOP_LOSS_PERCENT=2.0           # Initial stop loss
TRAILING_ACTIVATION_PERCENT=1.5 # Activate trailing after +1.5% profit
TRAILING_CALLBACK_PERCENT=0.5   # Trail distance from peak (0.5%)
# TAKE_PROFIT_PERCENT=3.0       # DEPRECATED - Using Smart Trailing instead!

MAX_POSITION_AGE_HOURS=3        # Максимальное время жизни позиции (часы)
MAX_COOL_DOWN_LIMIT = 8
COMMISSION_PERCENT=0.1          # Комиссия для расчета безубытка (%)

# Aged Position Management - Progressive Liquidation
AGED_GRACE_PERIOD_HOURS=8          # Grace period for breakeven attempts after MAX_POSITION_AGE
AGED_LOSS_STEP_PERCENT=0.5         # Loss step per hour after grace period (%)
AGED_MAX_LOSS_PERCENT=10.0         # Maximum loss before market close (%)
AGED_ACCELERATION_FACTOR=1.2       # Acceleration factor after 10h in progression
AGED_CHECK_INTERVAL_MINUTES=60     # Check aged positions every hour

MIN_SCORE_WEEK=50
MIN_SCORE_MONTH=50
MAX_SPREAD_PERCENT=2.0

# ===== SYMBOL FILTERING =====

# Stop-list: символы которые НИКОГДА не торгуем
# Формат: через запятую, пробел или точку с запятой
STOPLIST_SYMBOLS=BTCDOMUSDT,USDCUSDT,BUSDUSDT,EURBUSD,GBPBUSD

# Whitelist: если указан, торгуем ТОЛЬКО эти символы (опционально)
# Оставьте пустым или false чтобы отключить whitelist
USE_SYMBOL_WHITELIST=false
WHITELIST_SYMBOLS=

# Паттерны для исключения (wildcards: * = любые символы)
# Примеры: *UP,*DOWN - leveraged tokens; *BEAR,*BULL - leveraged
EXCLUDED_PATTERNS=*UP,*DOWN,*BEAR,*BULL,*3S,*3L,*2S,*2L

# Минимальный объем торгов для символа (USD за 24h) - 0 чтобы отключить
MIN_SYMBOL_VOLUME_USD=0

# Делистированные символы (для дополнительной защиты)
DELISTED_SYMBOLS=LUNAUSDT,USTUSDT,FTMUSDT

# System Configuration
ENVIRONMENT=development
LOG_LEVEL=INFO
DEBUG=false

# Monitoring
PROMETHEUS_PORT=8000
HEALTH_CHECK_PORT=8080
METRICS_ENABLED=true

MAX_EXPOSURE_USD=30000
MAX_TRADES_PER_15MIN=5

# Wave Processing with Buffer
SIGNAL_BUFFER_PERCENT=50        # Buffer for duplicate replacement (33% = 13 signals for 10 trades)
DUPLICATE_CHECK_ENABLED=true    # Enable duplicate position checking
ALLOW_MULTIPLE_POSITIONS=false  # Allow only one position per symbol

# ==================== WAVE DETECTION CONFIGURATION ====================
# Wave detection timing - when to check for waves (minutes after hour)
# Default: Check at 04, 18, 33, 48 minutes (3 mins after candle close at 01, 15, 30, 45)
WAVE_CHECK_MINUTES=6,20,35,50

# How long to wait for wave signals during detection period (seconds)
WAVE_CHECK_DURATION_SECONDS=240

# How often to check for new signals during wave detection (seconds)
WAVE_CHECK_INTERVAL_SECONDS=1

# Rate Limiting Configuration (20% below actual limits for safety)
# Binance actual: 20/sec, 1200/min -> Using: 16/sec, 960/min
BINANCE_RATE_LIMIT_PER_SEC=16
BINANCE_RATE_LIMIT_PER_MIN=960

# Bybit actual: 10/sec, 120/min -> Using: 8/sec, 96/min
BYBIT_RATE_LIMIT_PER_SEC=8
BYBIT_RATE_LIMIT_PER_MIN=96

# Default rate limits for other exchanges
DEFAULT_RATE_LIMIT_PER_SEC=5
DEFAULT_RATE_LIMIT_PER_MIN=60

# ==================== HEALTH CHECK CONFIGURATION ====================
# Health monitoring settings
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=60  # Check every 60 seconds
CRITICAL_CHECK_INTERVAL=10  # Check critical components every 10 seconds

# Health thresholds
MAX_RESPONSE_TIME_MS=1000  # Max acceptable response time in milliseconds
MAX_ERROR_COUNT=3  # Max consecutive errors before marking unhealthy
DEGRADED_THRESHOLD=0.8  # System degraded if less than 80% components healthy

# Health alerts
HEALTH_ALERT_ENABLED=true
MIN_BALANCE_ALERT=100  # Alert if balance drops below $100
MAX_MEMORY_MB=1000  # Alert if memory exceeds 1GB
MAX_POSITION_AGE_ALERT=48  # Alert for positions older than 48 hours

# Auto-recovery
AUTO_RECOVERY_ENABLED=true
MAX_RECOVERY_ATTEMPTS=3  # Max recovery attempts before giving up
TEST_MODE=false

# Signal processing
SIGNAL_TIME_WINDOW_MINUTES=30  # Allow signals up to 30 minutes old

# Leverage (default: 10 for all exchanges)
LEVERAGE=10
# Wave data cleanup
WAVE_CLEANUP_HOURS=2

# WebSocket Signal Server
SIGNAL_WS_URL=ws://217.154.19.224:8765
SIGNAL_WS_TOKEN=secure_websocket_pass_2024
SIGNAL_WS_AUTO_RECONNECT=true
SIGNAL_WS_RECONNECT_INTERVAL=5

# Enable WebSocket signal stream (set to 'true' to migrate from PostgreSQL polling)
USE_WEBSOCKET_SIGNALS=true
