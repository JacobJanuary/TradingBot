# üìã SUMMARY: Type Error Fix Plan

## –û–®–ò–ë–ö–ê
```
Failed to create monitoring event: invalid input for query argument $1: 2745 (expected str, got int)
```

## –ö–û–†–ù–ï–í–ê–Ø –ü–†–ò–ß–ò–ù–ê
`position.id` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **int** (2745), –ù–ï –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ **str** –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ `AgedPositionTarget`

## –í–õ–ò–Ø–ù–ò–ï
- ‚ùå 4 –≤—ã–∑–æ–≤–∞ `create_aged_monitoring_event` –ø–µ—Ä–µ–¥–∞—é—Ç int –≤–º–µ—Å—Ç–æ str
- ‚ùå asyncpg –æ—Ç–∫–ª–æ–Ω—è–µ—Ç int –¥–ª—è VARCHAR(255)
- ‚ùå Monitoring events –ù–ï –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –±–∞–∑—É

## –†–ï–®–ï–ù–ò–ï (1 –°–¢–†–û–ö–ê!)

**–§–∞–π–ª:** core/aged_position_monitor_v2.py:157

**–ë–´–õ–û:**
```python
position_id=getattr(position, 'id', symbol)
```

**–î–û–õ–ñ–ù–û –ë–´–¢–¨:**
```python
position_id=str(getattr(position, 'id', symbol))
```

## –û–ë–û–°–ù–û–í–ê–ù–ò–ï
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª—è–µ—Ç –≤ –ò–°–¢–û–ß–ù–ò–ö–ï (1 –º–µ—Å—Ç–æ –≤–º–µ—Å—Ç–æ 4)
- ‚úÖ –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —á—Ç–æ position_id –≤—Å–µ–≥–¥–∞ str
- ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç dataclass –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏
- ‚úÖ str() –±–µ–∑–æ–ø–∞—Å–Ω–∞ –¥–ª—è –æ–±–æ–∏—Ö —Å–ª—É—á–∞–µ–≤ (int ‚Üí str, str ‚Üí str)

## –ü–†–û–í–ï–†–ö–ê
```bash
python3 tests/test_aged_monitoring_type_investigation.py
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ü–û–°–õ–ï –§–ò–ö–°–ê:**
- ‚úÖ –¢–µ—Å—Ç 4: "‚úÖ position_id –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ str()"
- ‚úÖ –¢–µ—Å—Ç 5: "‚úÖ –í—Å–µ –≤—ã–∑–æ–≤—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã (–∏—Å–ø–æ–ª—å–∑—É—é—Ç str)"

## –°–í–Ø–ó–ê–ù–ù–´–ï –§–ò–ö–°–´
–≠—Ç–æ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Ñ–∏–∫—Å–æ–≤:
- ‚úÖ create_aged_position - –¥–æ–±–∞–≤–ª–µ–Ω str() (–∫–æ–º–º–∏—Ç 0989488)
- ‚úÖ mark_aged_position_closed - –¥–æ–±–∞–≤–ª–µ–Ω str() (–∫–æ–º–º–∏—Ç c74489a)
- ‚ùå **–ù–ï –ò–°–ü–†–ê–í–õ–ï–ù–û**: create_aged_monitoring_event (4 –≤—ã–∑–æ–≤–∞)

**–¢–ê –ñ–ï –ö–û–†–ù–ï–í–ê–Ø –ü–†–ò–ß–ò–ù–ê:** position.id –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç int, –±–∞–∑–∞ —Ç—Ä–µ–±—É–µ—Ç VARCHAR

## –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø
- üìÑ –ü–æ–ª–Ω–æ–µ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ: INVESTIGATION_AGED_MONITORING_TYPE_ERROR_20251023.md
- üß™ –¢–µ—Å—Ç—ã: tests/test_aged_monitoring_type_investigation.py
