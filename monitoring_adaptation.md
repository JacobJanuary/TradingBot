# –ê–¥–∞–ø—Ç–∞—Ü–∏—è —Å–∫—Ä–∏–ø—Ç–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

## –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—É—Ç–∏
- **–õ–æ–≥ —Ñ–∞–π–ª:** logs/trading_bot.log
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL
  - Host: –∏–∑ DB_HOST –≤ .env (default: localhost)
  - Port: –∏–∑ DB_PORT –≤ .env (default: 5433)
  - Database: –∏–∑ DB_NAME –≤ .env (default: fox_crypto)
  - User: –∏–∑ DB_USER –≤ .env (default: elcrypto)
  - Password: –∏–∑ DB_PASSWORD –≤ .env

## –§–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤
–ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä–æ–∫ –∏–∑ –ª–æ–≥–æ–≤:
```
2025-10-17 04:56:54,682 - core.event_logger - INFO - position_updated: {'symbol': 'IDEXUSDT', 'position_id': 379, 'old_price': 0.02245, 'new_price': 0.02246}
2025-10-17 04:57:00,592 - core.aged_position_manager - ERROR - Error checking aged positions: Invalid format specifier
2025-10-17 04:57:01,081 - core.stop_loss_manager - INFO - ‚úÖ Position AINUSDT has Stop Loss order: 8801554 at 0.13521
2025-10-17 04:57:01,081 - core.position_manager - INFO - Checking position AINUSDT: has_sl=True, price=0.13521
```

## –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
–°–∫—Ä–∏–ø—Ç monitor_bot.py —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ –ª–æ–≥–æ–≤:

- –í–æ–ª–Ω—ã –∏ —Å–∏–≥–Ω–∞–ª—ã
- –ü–æ–∑–∏—Ü–∏–∏ (–æ—Ç–∫—Ä—ã—Ç–∏–µ, –∑–∞–∫—Ä—ã—Ç–∏–µ, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)
- Stop Loss (—Å–æ–∑–¥–∞–Ω–∏–µ, –ø—Ä–æ–≤–µ—Ä–∫–∞, –¥–≤–∏–∂–µ–Ω–∏–µ)
- Trailing Stop (–∞–∫—Ç–∏–≤–∞—Ü–∏—è, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)
- Protection –º–æ–¥—É–ª—å (–ø—Ä–æ–≤–µ—Ä–∫–∏)
- Zombie orders (–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ)
- Aged –ø–æ–∑–∏—Ü–∏–∏ (–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ, –æ–±—Ä–∞–±–æ—Ç–∫–∞)
- WebSocket —Å–æ–±—ã—Ç–∏—è
- –û—à–∏–±–∫–∏ –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

## –°—Ö–µ–º–∞ –ë–î

### –°—Ö–µ–º–∞ monitoring
- **positions** - –û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏
  - id, symbol, exchange, side, quantity
  - entry_price, has_stop_loss, stop_loss_price
  - trailing_activated, status, opened_at
  - unrealized_pnl

### –°—Ö–µ–º–∞ trading
- **orders** - –û—Ä–¥–µ—Ä–∞
  - id, symbol, exchange, type, side
  - status, created_at

## –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã
–ó–∞–ø—Ä–æ—Å—ã –≤ monitor_bot.py —É–∂–µ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ–¥ —Ä–µ–∞–ª—å–Ω—É—é —Å—Ö–µ–º—É:
```sql
-- –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π
SELECT * FROM monitoring.positions WHERE status = 'OPEN';

-- –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤
SELECT * FROM trading.orders
WHERE status IN ('open', 'NEW', 'PARTIALLY_FILLED', 'PENDING');
```

## –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ reduceOnly –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
–°–∫—Ä–∏–ø—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ–º reduceOnly –≤ SL –æ—Ä–¥–µ—Ä–∞—Ö

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ heartbeat –¥–ª—è Bybit
–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ WebSocket disconnects –∏ reconnects –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º —Å heartbeat

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ aged –ø–æ–∑–∏—Ü–∏–π
–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π —Å—Ç–∞—Ä—à–µ MAX_POSITION_AGE_HOURS

### 4. Zombie order detection
–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è –∑–æ–º–±–∏-–æ—Ä–¥–µ—Ä–æ–≤

## –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

1. **–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –±–æ—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
ps aux | grep "python.*main.py"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ª–æ–≥-—Ñ–∞–π–ª –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
tail -f logs/trading_bot.log
```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:**
```bash
# –ò–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
python monitor_bot.py
```

3. **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –≤—ã–≤–æ–¥–∞:**
- –ö–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –æ—Ç—á–µ—Ç
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –ø–æ–º–µ—á–∞—é—Ç—Å—è üî¥
- –í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ –ø–æ–º–µ—á–∞–µ—Ç—Å—è üü†
- JSON –æ—Ç—á–µ—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ monitoring_report_XXX.json
- –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –≤ monitoring_final_report.json

## –ß—Ç–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä

### –°–æ–±—ã—Ç–∏—è
- üåä –ü–æ–ª—É—á–µ–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–æ–ª–Ω
- üìà –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π
- üõ°Ô∏è –°–æ–∑–¥–∞–Ω–∏–µ Stop Loss
- üéØ –ê–∫—Ç–∏–≤–∞—Ü–∏—è Trailing Stop
- ‚úÖ/‚ùå –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π —Å PnL
- üßü –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ zombie orders
- ‚è∞ Aged –ø–æ–∑–∏—Ü–∏–∏
- üîå WebSocket —Ä–∞–∑—Ä—ã–≤—ã –∏ —Ä–µ–∫–æ–Ω–Ω–µ–∫—Ç—ã

### –ê–Ω–æ–º–∞–ª–∏–∏
- –ü–æ–∑–∏—Ü–∏–∏ –±–µ–∑ SL –±–æ–ª–µ–µ 60 —Å–µ–∫—É–Ω–¥
- –†–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ë–î –∏ –ª–æ–≥–æ–≤
- –í—ã—Å–æ–∫–∞—è —á–∞—Å—Ç–æ—Ç–∞ –æ—à–∏–±–æ–∫ (>5 –∑–∞ 10 –º–∏–Ω)
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ reduceOnly –≤ SL –æ—Ä–¥–µ—Ä–∞—Ö

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π
- –ü–æ–∑–∏—Ü–∏–∏ —Å –∞–∫—Ç–∏–≤–Ω—ã–º Trailing Stop
- –ü–æ–∑–∏—Ü–∏–∏ –æ–∂–∏–¥–∞—é—â–∏–µ SL
- Aged –ø–æ–∑–∏—Ü–∏–∏
- –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π –ø–æ —Ç–∏–ø–∞–º