# –†–ê–°–°–õ–ï–î–û–í–ê–ù–ò–ï: Aged –ø–æ–∑–∏—Ü–∏–∏ –Ω–µ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è

**–î–∞—Ç–∞:** 2025-10-23 05:41
**–°—Ç–∞—Ç—É—Å:** üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê
**–ê–≤—Ç–æ—Ä:** Claude (AI Assistant)

---

## üéØ –ü–†–û–ë–õ–ï–ú–ê

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–æ–±—â–∏–ª:
> "—è –≤–∏–∂—É –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–∑–∏—Ü–∏–∏ –≤ –ø–ª—é—Å–µ, –∫–æ—Ç–æ—Ä—ã–µ MAX_POSITION_AGE_HOURS>3 –ø–æ—á–µ–º—É –º–æ–¥—É–ª—å –∏—Ö –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç?"

---

## üìä –ù–ê–•–û–î–ö–ò

### 1. –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ë–î

–ù–∞–π–¥–µ–Ω–æ **15 –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π —Å—Ç–∞—Ä—à–µ 3 —á–∞—Å–æ–≤:**

| –í–æ–∑—Ä–∞—Å—Ç | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ | –°–∏–º–≤–æ–ª—ã | Trailing | PnL Range |
|---------|------------|---------|----------|-----------|
| 7.0h    | 14         | PRCLUSDT, XDCUSDT, OKBUSDT, SAROSUSDT, etc. | false | -7.68% to +3.97% |
| 4.4h    | 1          | **A2ZUSDT** | false | **+0.77%** |

**–ü–æ–∑–∏—Ü–∏–∏ 7.0h –≤ –ø–ª—é—Å–µ:**
- RADUSDT: +3.97%
- STOUSDT: +0.88%
- IDUSDT: +1.03%
- SAROSUSDT: +0.19%
- OKBUSDT: +0.08%
- SOSOUSDT: +0.08%
- SHIB1000USDT: +0.12%

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**–û–∂–∏–¥–∞–µ–º–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
```env
MAX_POSITION_AGE_HOURS=3        # –ü–æ—Ä–æ–≥ aged
AGED_GRACE_PERIOD_HOURS=8       # Grace –ø–µ—Ä–∏–æ–¥
```

**–§–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
```env
# .env —Å—Ç—Ä–æ–∫–∞ 37:
AGED_GRACE_PERIOD_HOURS=8

# .env —Å—Ç—Ä–æ–∫–∞ 202:
AGED_GRACE_PERIOD_HOURS=1    ‚Üê –ü–ï–†–ï–û–ü–†–ï–î–ï–õ–Ø–ï–¢!
```

**–õ–æ–≥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç:**
```
2025-10-23 05:29:21,280 - core.aged_position_monitor_v2 - INFO - AgedPositionMonitorV2 initialized: max_age=3h, grace=1h
```

### 3. –õ–æ–≥–∏–∫–∞ aged_position_manager

**–ò–∑ –∫–æ–¥–∞ (`core/aged_position_monitor_v2.py`):**

1. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ aged:**
   ```python
   async def check_position_age(self, position) -> bool:
       age_hours = self._calculate_age_hours(position)
       return age_hours > self.max_age_hours  # > 3h
   ```

2. **–ó–∞–∫—Ä—ã—Ç–∏–µ profitable –ø–æ–∑–∏—Ü–∏–π:**
   ```python
   async def check_price_target(self, symbol: str, current_price: Decimal):
       pnl_percent = self._calculate_pnl_percent(position, current_price)

       if pnl_percent > 0:
           # Profitable - close immediately
           should_close = True
           logger.info(f"üí∞ {symbol} profitable at {pnl_percent:.2f}% - triggering close")
   ```

3. **–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ:**
   - –ü–æ—Å–ª–µ `MAX_POSITION_AGE + AGED_GRACE_PERIOD`
   - –° —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏: `3 + 1 = 4 —á–∞—Å–æ–≤`

---

## üîç –ö–û–†–ù–ï–í–´–ï –ü–†–ò–ß–ò–ù–´

### –ü—Ä–æ–±–ª–µ–º–∞ #1: üî¥ –î–£–ë–õ–ò–ö–ê–¢ –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò

**–§–∞–π–ª:** `.env`
**–°—Ç—Ä–æ–∫–∏:** 37 –∏ 202

```env
# –°—Ç—Ä–æ–∫–∞ 37 (–≤–µ—Ä–Ω–∞—è):
AGED_GRACE_PERIOD_HOURS=8          # Grace period for breakeven attempts after MAX_POSITION_AGE

# –°—Ç—Ä–æ–∫–∞ 202 (–ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ):
AGED_GRACE_PERIOD_HOURS=1
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- Grace period = 1 —á–∞—Å –≤–º–µ—Å—Ç–æ 8
- –ü–æ–∑–∏—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –∑–∞–∫—Ä—ã–≤–∞—Ç—å—Å—è –ø–æ—Å–ª–µ `3 + 1 = 4 —á–∞—Å–æ–≤`
- –ü–æ–∑–∏—Ü–∏–∏ 7.0h **–¥–∞–≤–Ω–æ –ø–µ—Ä–µ—à–ª–∏ –ø–æ—Ä–æ–≥** 4h

---

### –ü—Ä–æ–±–ª–µ–º–∞ #2: üü° A2ZUSDT –ù–ï –í AGED MONITOR

**–ü–æ–∑–∏—Ü–∏—è A2ZUSDT:**
- –í–æ–∑—Ä–∞—Å—Ç: 4.4 —á–∞—Å–∞ (> 3h –ø–æ—Ä–æ–≥–∞)
- PnL: +0.77% (–≤ –ø–ª—é—Å–µ!)
- Trailing: false (–Ω–µ –ø—Ä–æ–ø—É—â–µ–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–æ–º)
- –°—Ç–∞—Ç—É—Å: active

**–ù–æ –≤ –ª–æ–≥–∞—Ö:**
```
2025-10-23 05:39:10 - üìç Aged position added: HNTUSDT (age=3.9h)
2025-10-23 05:39:10 - üìç Aged position added: RADUSDT (age=3.9h)
...
(A2ZUSDT –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç)
```

**–ü—Ä–∏—á–∏–Ω–∞:**
A2ZUSDT –Ω–µ –≤ `position_manager.positions` –≤ –º–æ–º–µ–Ω—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (05:17-05:39).

–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
- –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ A2ZUSDT price: 01:21 (–ø–µ—Ä–µ–¥ —Ä–µ—Å—Ç–∞—Ä—Ç–æ–º)
- –ü—Ä–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–µ –≤ 05:17: "Checking position A2ZUSDT: has_sl=True"
- –ù–æ –ø–æ–∑–∏—Ü–∏—è –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ aged_targets

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. –ü–æ–∑–∏—Ü–∏—è –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –≤ memory `positions` dict
2. –û—à–∏–±–∫–∞ –≤ `check_position_age()` (–Ω–µ –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∞)
3. Race condition –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ

---

### –ü—Ä–æ–±–ª–µ–º–∞ #3: üî¥ –ú–ï–•–ê–ù–ò–ó–ú –ó–ê–ö–†–´–¢–ò–Ø –ù–ï –†–ê–ë–û–¢–ê–ï–¢

**–û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏ (–µ—Å–ª–∏ –±—ã –º–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–±–æ—Ç–∞–ª):**
```
üí∞ RADUSDT profitable at 3.97% - triggering close
üéØ Aged target reached for RADUSDT
```

**–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ª–æ–≥–∏:**
- ‚ùå –ù–µ—Ç –ª–æ–≥–æ–≤ "üí∞ profitable"
- ‚ùå –ù–µ—Ç –ª–æ–≥–æ–≤ "üéØ Aged target reached"
- ‚ùå –ù–µ—Ç –≤—ã–∑–æ–≤–æ–≤ `_trigger_market_close`

**–ü—Ä–∏—á–∏–Ω–∞:**
–ú–µ—Ç–æ–¥ `check_price_target()` **–Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è**.

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞:**
```python
# aged_position_monitor_v2.py:113
async def check_price_target(self, symbol: str, current_price: Decimal):
    """
    Check if current price reached target for aged position
    Called by UnifiedPriceMonitor through adapter
    """
```

**UnifiedPriceMonitor —Å—Ç–∞—Ç—É—Å:**
```
2025-10-23 05:29:21,284 - websocket.unified_price_monitor - INFO - UnifiedPriceMonitor started (minimal mode)
```

**–ü—Ä–æ–±–ª–µ–º–∞:** "minimal mode" –º–æ–∂–µ—Ç –Ω–µ –≤—ã–∑—ã–≤–∞—Ç—å aged_position_monitor callbacks.

---

## üìà –•–†–û–ù–û–õ–û–ì–ò–Ø

### 01:20 - A2ZUSDT –æ—Ç–∫—Ä—ã—Ç–∞
```
01:20:31 - Opening position ATOMICALLY: A2ZUSDT BUY 51934.0
01:20:42 - ‚úÖ Position A2ZUSDT has Stop Loss order: 10675670 at 0.00378
```

### 05:14 - –ü–µ—Ä–≤—ã–π —Ä–µ—Å—Ç–∞—Ä—Ç
```
05:14:33 - AgedPositionMonitorV2 initialized: max_age=3h, grace=1h
```

### 05:17 - –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π
```
05:17:13 - Checking position A2ZUSDT: has_sl=True, price=0.00378
05:17:18 - üìç Aged position added: HNTUSDT (age=3.5h)
05:17:18 - üìç Aged position added: RADUSDT (age=3.5h)
...
(A2ZUSDT –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω–∞)
```

### 05:29 - –í—Ç–æ—Ä–æ–π —Ä–µ—Å—Ç–∞—Ä—Ç (–¥–µ–ø–ª–æ–π duplicate fix)
```
05:29:21 - AgedPositionMonitorV2 initialized: max_age=3h, grace=1h
05:29:21 - UnifiedPriceMonitor started (minimal mode)
```

### 05:36-05:41 - –ü–æ–∑–∏—Ü–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã, –Ω–æ –Ω–µ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è
```
05:36:48 - üìç Aged position added: XDCUSDT (age=3.9h, phase=grace, target=$0.0599)
05:39:10 - üìç Aged position added: HNTUSDT (age=3.9h, phase=grace, target=$1.7533)
...
(–ù–µ—Ç –ø–æ–ø—ã—Ç–æ–∫ –∑–∞–∫—Ä—ã—Ç–∏—è)
```

---

## üõ†Ô∏è –†–ï–®–ï–ù–ò–ï

### 1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç –≤ .env

**–î–µ–π—Å—Ç–≤–∏–µ:** –£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫—É 202

```bash
# –ù–∞–π—Ç–∏ –¥—É–±–ª–∏–∫–∞—Ç
grep -n "AGED_GRACE_PERIOD_HOURS" .env

# –£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫—É 202
sed -i '202d' .env
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- Grace period = 8 —á–∞—Å–æ–≤
- –ü–æ–∑–∏—Ü–∏–∏ –±—É–¥—É—Ç –∑–∞–∫—Ä—ã–≤–∞—Ç—å—Å—è –ø–æ—Å–ª–µ `3 + 8 = 11 —á–∞—Å–æ–≤`

### 2. –î–æ–±–∞–≤–∏—Ç—å A2ZUSDT –≤ aged monitor –≤—Ä—É—á–Ω—É—é

**–í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:** –î–æ–∂–¥–∞—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ü–∏–∫–ª–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

**–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:** –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å, –ø–æ—á–µ–º—É –ø–æ–∑–∏—Ü–∏—è –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ `position_manager.positions`

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å UnifiedPriceMonitor

**–ü—Ä–æ–±–ª–µ–º–∞:** "minimal mode" –º–æ–∂–µ—Ç –Ω–µ –≤—ã–∑—ã–≤–∞—Ç—å aged callbacks

**–î–µ–π—Å—Ç–≤–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥ `UnifiedPriceMonitor` –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

---

## üìä –û–ñ–ò–î–ê–ï–ú–û–ï –ü–û–í–ï–î–ï–ù–ò–ï

### –° AGED_GRACE_PERIOD_HOURS=8:

| –í–æ–∑—Ä–∞—Å—Ç | –°—Ç–∞—Ç—É—Å | –î–µ–π—Å—Ç–≤–∏–µ |
|---------|--------|----------|
| 0-3h    | Normal | –ù–µ—Ç –¥–µ–π—Å—Ç–≤–∏–π |
| 3-11h   | Aged (grace) | Breakeven attempts, –ù–ï –∑–∞–∫—Ä—ã–≤–∞—Ç—å |
| 11h+    | Aged (force) | –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ |

**–¢–µ–∫—É—â–∏–µ –ø–æ–∑–∏—Ü–∏–∏:**
- 7.0h ‚Üí –í grace —Ñ–∞–∑–µ ‚Üí **–ù–ï –∑–∞–∫—Ä—ã–≤–∞—Ç—å** (–ø—Ä–∞–≤–∏–ª—å–Ω–æ)
- 4.4h ‚Üí –í grace —Ñ–∞–∑–µ ‚Üí **–ù–ï –∑–∞–∫—Ä—ã–≤–∞—Ç—å** (–ø—Ä–∞–≤–∏–ª—å–Ω–æ)

### –° AGED_GRACE_PERIOD_HOURS=1 (—Ç–µ–∫—É—â–µ–µ):

| –í–æ–∑—Ä–∞—Å—Ç | –°—Ç–∞—Ç—É—Å | –î–µ–π—Å—Ç–≤–∏–µ |
|---------|--------|----------|
| 0-3h    | Normal | –ù–µ—Ç –¥–µ–π—Å—Ç–≤–∏–π |
| 3-4h    | Aged (grace) | Breakeven attempts |
| 4h+     | Aged (force) | **–î–û–õ–ñ–ù–´ –ë–´–¢–¨ –ó–ê–ö–†–´–¢–´!** |

**–¢–µ–∫—É—â–∏–µ –ø–æ–∑–∏—Ü–∏–∏:**
- 7.0h ‚Üí –°—Ç–∞—Ä—à–µ 4h ‚Üí **–î–û–õ–ñ–ù–´ –ë–´–¢–¨ –ó–ê–ö–†–´–¢–´** ‚ùå
- 4.4h ‚Üí –°—Ç–∞—Ä—à–µ 4h ‚Üí **–î–û–õ–ñ–ù–ê –ë–´–¢–¨ –ó–ê–ö–†–´–¢–ê** ‚ùå

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ—Ö–∞–Ω–∏–∑–º –∑–∞–∫—Ä—ã—Ç–∏—è –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç!

---

## üéØ –ö–†–ò–¢–ò–ß–ù–û–°–¢–¨

**–£—Ä–æ–≤–µ–Ω—å:** üî¥ HIGH

**–ü—Ä–∏—á–∏–Ω—ã:**
1. **–î—É–±–ª–∏–∫–∞—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏** - –ª–µ–≥–∫–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å
2. **A2ZUSDT –Ω–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è** - —Å—Ä–µ–¥–Ω—è—è –ø—Ä–æ–±–ª–µ–º–∞
3. **–ú–µ—Ö–∞–Ω–∏–∑–º –∑–∞–∫—Ä—ã—Ç–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç** - **–ö–†–ò–¢–ò–ß–ù–û**

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
- –ü–æ–∑–∏—Ü–∏–∏ –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è –±–µ–∑ –∑–∞–∫—Ä—ã—Ç–∏—è
- –†–∏—Å–∫ –±–æ–ª—å—à–∏—Ö —É–±—ã—Ç–∫–æ–≤
- aged_position_manager —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ **–Ω–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç**

---

## üìù –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ:

1. ‚úÖ **–ò—Å–ø—Ä–∞–≤–∏—Ç—å .env** - —É–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç AGED_GRACE_PERIOD_HOURS –Ω–∞ —Å—Ç—Ä–æ–∫–µ 202
2. ‚úÖ **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞** - –ø—Ä–∏–º–µ–Ω–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
3. ‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ª–æ–≥–∏** - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø–æ—è–≤—è—Ç—Å—è –ª–∏ –∑–∞–∫—Ä—ã—Ç–∏—è aged –ø–æ–∑–∏—Ü–∏–π

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ (24 —á–∞—Å–∞):

1. –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å, –ø–æ—á–µ–º—É UnifiedPriceMonitor –≤ "minimal mode" –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç callbacks
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø–æ—á–µ–º—É A2ZUSDT –Ω–µ –≤ `position_manager.positions`
3. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è aged_position_monitor_v2

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ:

1. –î–æ–±–∞–≤–∏—Ç—å validation –¥–ª—è .env –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã
2. –î–æ–±–∞–≤–∏—Ç—å health check –¥–ª—è aged_position_manager
3. –î–æ–±–∞–≤–∏—Ç—å –∞–ª–µ—Ä—Ç—ã, –µ—Å–ª–∏ –ø–æ–∑–∏—Ü–∏–∏ —Å—Ç–∞—Ä—à–µ MAX_POSITION_AGE –Ω–µ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è

---

## üîç –î–ò–ê–ì–ù–û–°–¢–ò–ß–ï–°–ö–ò–ï –ö–û–ú–ê–ù–î–´

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã –≤ .env:
```bash
grep "AGED_GRACE_PERIOD_HOURS" .env
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å aged –ø–æ–∑–∏—Ü–∏–∏ –≤ –ë–î:
```sql
SELECT
    symbol,
    ROUND(EXTRACT(EPOCH FROM (NOW() - created_at))/3600, 1) as age_hours,
    trailing_activated,
    ROUND(((current_price - entry_price) / entry_price * 100)::numeric, 2) as pnl_percent
FROM monitoring.positions
WHERE status = 'active'
  AND created_at < NOW() - INTERVAL '3 hours'
ORDER BY created_at ASC;
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –∑–∞–∫—Ä—ã—Ç–∏—è:
```bash
tail -f logs/trading_bot.log | grep -E "üí∞|üéØ|market.*close|Aged target"
```

---

## ‚úÖ –°–¢–ê–¢–£–°

- [x] –ü—Ä–æ–±–ª–µ–º–∞ –≤—ã—è–≤–ª–µ–Ω–∞
- [x] –ö–æ—Ä–Ω–µ–≤—ã–µ –ø—Ä–∏—á–∏–Ω—ã –Ω–∞–π–¥–µ–Ω—ã
- [ ] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ
- [ ] –ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞

---

END OF INVESTIGATION REPORT
